<!DOCTYPE html>
<html>
<head>
  <title>Task Chat</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .chat-box {
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 10px;
    }
    .message {
      margin-bottom: 8px;
    }
    .admin { color: #007bff; font-weight: bold; }
    .worker { color: #28a745; font-weight: bold; }
    .timestamp { font-size: 0.8rem; color: #888; }
  </style>
</head>
<body class="container py-4">
  <h3 class="mb-3">ðŸ’¬ Chat for Task ID: {{ task_id }}</h3>
  <div class="chat-box" id="chatBox">
    {% for msg in chat_history %}
      <div class="message">
        <span class="{{ msg[0].lower() }}">{{ msg[0].capitalize() }}</span>: {{ msg[1] }}<br>
        <span class="timestamp">{{ msg[2] }}</span>
      </div>
    {% endfor %}
  </div>

  <form method="POST" class="d-flex gap-2">
    <input name="message" class="form-control" placeholder="Type your message..." required>
    <button type="submit" class="btn btn-primary">Send</button>
  </form>

  <script>
    // Auto-scroll chat to bottom
    const box = document.getElementById('chatBox');
    box.scrollTop = box.scrollHeight;
  </script>
</body>
</html>
